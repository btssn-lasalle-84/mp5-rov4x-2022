<div id="screenshot">
    <video autoplay></video>
    <img src="">
    <canvas style="display:none;"></canvas>
    <div>
        <button class="capture-button">d√©marer  video</button>
        <button id="screenshot-button">prendre un screenshot</button>
    </div>
  </div>
  <script>
    const constraints = {
      video: { width: 640, height: 480 }
    };
  
    const captureVideoButton = document.querySelector('#screenshot .capture-button');
    const screenshotButton = document.querySelector('#screenshot-button');
    const img = document.querySelector('#screenshot img');
    const video = document.querySelector('#screenshot video');
  
    const canvas = document.createElement('canvas');
  
    captureVideoButton.onclick = function () {
      navigator.mediaDevices
               .getUserMedia(constraints)
               .then(handleSuccess)
               .catch(handleError);
    };
  
    screenshotButton.onclick = video.onclick = function () {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      canvas.getContext('2d').drawImage(video, 0, 0);
  
      img.src = canvas.toDataURL('image/png');
    };
  
    function handleSuccess(stream) {
      screenshotButton.disabled = false;
      video.srcObject = stream;
    }
  
    function handleError(error) {
      console.error('Error: ', error);
    }
  </script>
  <script>
    (function ($) {
      $(document).ready(function() {
        $("#screenshot img").on("load", function() {
          $.ajax({
            type: "POST",
            url: "/api/faces/register",
            data: $(this).attr("src")
          });
        });
      });
    })(jQuery);
  </script>